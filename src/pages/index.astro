---
import Landing from '../components/Landing.astro';
import Layout from '../layouts/Layout.astro';
import { Image } from "astro:assets";
import { getCollection } from 'astro:content';
const posts = await getCollection('posts');
const filteredPosts = posts.filter(post => !post.data.draft);

var options = { year: 'numeric', month: 'long', day: 'numeric' };
---

<Layout>
	<Landing />

    <!-- Featured Latest Posts Section -->
    <section class="container mx-auto px-4 py-8">
		<h2 class="text-2xl font-semibold mb-6">Latest Posts</h2>
		<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
		  {filteredPosts
			.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime())
			.slice(0, 3)
			.map(v => (
			  <a href={`/posts/${v.slug}/`} class="card card-border bg-base-200 shadow-xl hover:shadow-2xl transition-shadow duration-300 ease-in-out">
				<figure class="p-2">
				  <Image 
					src={v.data.cover}
					alt={v.data.title}
					width={560}
					height={315}
					class="w-full h-auto object-cover"
				  />
				</figure>
				<div class="card-body">
				  <h2 class="card-title xl:m-auto">{v.data.title}</h2>
				  <p class="text-sm text-black/70 font-bold xl:m-auto">{new Date(v.data.date).toLocaleDateString("en-us", options)}</p>
				  <p class="badge badge-primary xl:m-auto">{v.data.category}</p>
				</div>
			  </a>
			))}
		</div>
		<div class="flex justify-center mt-8">
		  <a href="/posts" class="btn btn-primary">See all posts</a>
		</div>
	  </section>
</Layout>
